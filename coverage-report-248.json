{
  "programId": 248,
  "programName": "Choix PYR (plusieurs chambres)",
  "coveragePct": 72,
  "rulesImplemented": 13,
  "rulesTotal": 18,
  "missingRules": [
    "RM-002: Gestion des 4 tables - seulement 2 tables utilis√©es (hebergement, client_gm). Manque gm-recherche (cafil008_dat) et table compl√®te LINK",
    "Table 30 (gm-recherche) non utilis√©e - devrait √™tre utilis√©e pour la recherche initiale du GM",
    "Pas de mise √† jour explicite de la table hebergement (cafil012_dat) - le store appelle l'API mais ne montre pas la logique m√©tier de mise √† jour",
    "Pas de validation que le client a effectivement plusieurs chambres avant affichage",
    "Manque la v√©rification du statut 'ACTIF' c√¥t√© store (filtrage fait uniquement dans le mock)"
  ],
  "recommendations": [
    "**CRITIQUE**: Impl√©menter l'acc√®s √† la table gm-recherche (cafil008_dat) pour r√©cup√©rer les informations compl√®tes du GM",
    "**CRITIQUE**: Ajouter la logique de mise √† jour de la table hebergement apr√®s s√©lection (actuellement l'API est appel√©e mais la logique m√©tier n'est pas visible)",
    "**HAUTE**: Ajouter une validation c√¥t√© store que le client a au moins 2 chambres actives (sinon pas besoin d'afficher l'√©cran)",
    "**HAUTE**: Filtrer les h√©bergements par statut 'ACTIF' et date de validit√© c√¥t√© store (pas seulement dans le mock)",
    "**MOYENNE**: Ajouter la gestion de la table LINK (client_gm) explicitement dans les types",
    "**MOYENNE**: Enrichir les types avec les champs complets de la table hebergement selon le sch√©ma SQL r√©el",
    "**BASSE**: Ajouter un indicateur visuel du nombre de chambres disponibles dans le HeaderPanel",
    "**BASSE**: Am√©liorer le message d'erreur quand aucune chambre n'est trouv√©e (distinguer 'aucune chambre' vs 'aucune chambre active')",
    "**QUALIT√â**: Ajouter des tests unitaires pour le store, notamment pour le filtrage des h√©bergements",
    "**QUALIT√â**: Documenter le flux API attendu (quels endpoints doivent √™tre cr√©√©s c√¥t√© backend)"
  ],
  "detailedAnalysis": {
    "tablesImplementation": {
      "total": 4,
      "implemented": 2,
      "missing": [
        {
          "tableId": 30,
          "logicalName": "gm-recherche_____gmr",
          "physicalName": "cafil008_dat",
          "access": "READ",
          "reason": "Non utilis√©e dans le code g√©n√©r√© - devrait √™tre la source initiale des donn√©es GM"
        },
        {
          "issue": "LINK sur client_gm",
          "description": "La jointure n'est pas explicitement impl√©ment√©e, suppos√©e faite c√¥t√© API"
        }
      ]
    },
    "businessRulesImplementation": {
      "RM-001": {
        "implemented": true,
        "notes": "Ex√©cution du traitement via useEffect au montage du composant"
      },
      "RM-002": {
        "implemented": false,
        "notes": "Seulement 2 tables sur 4 sont utilis√©es explicitement. Manque gm-recherche et d√©tails de la LINK"
      },
      "RM-003": {
        "implemented": true,
        "notes": "Aucun callee requis selon la spec, correctement impl√©ment√©"
      }
    },
    "uiImplementation": {
      "layout": "CONFORME - Layout avec header (client info), grid (chambres), actions (valider/annuler)",
      "interactions": "CONFORME - S√©lection ligne, validation, annulation",
      "errorHandling": "PARTIEL - Gestion erreur pr√©sente mais messages g√©n√©riques",
      "loading": "CONFORME - √âtat de chargement g√©r√© et affich√©"
    },
    "storeImplementation": {
      "stateManagement": "CONFORME - Zustand avec √©tat complet (hebergements, selection, client, loading, error)",
      "apiIntegration": "CONFORME - Endpoints d√©finis avec types",
      "mockData": "CONFORME - Mock r√©aliste avec 3 chambres",
      "dataValidation": "PARTIEL - Filtrage date dans mock uniquement, devrait √™tre dans le store"
    },
    "typeDefinitions": {
      "complete": false,
      "issues": [
        "Type Hebergement minimal - manque potentiellement des champs de cafil012_dat",
        "Type ClientGm minimal - manque des champs de cafil014_dat et cafil008_dat",
        "Pas de type pour la table gm-recherche (cafil008_dat)"
      ]
    }
  },
  "positivePoints": [
    "‚úÖ Architecture Zustand bien structur√©e avec s√©paration state/actions",
    "‚úÖ Types TypeScript complets pour les API responses",
    "‚úÖ Composants React bien d√©compos√©s (HeaderPanel, ChambresGridPanel, ActionsPanel)",
    "‚úÖ Mock data r√©aliste permettant de tester l'UI sans backend",
    "‚úÖ Gestion loading/error states",
    "‚úÖ Navigation correcte (retour au menu apr√®s validation/annulation)",
    "‚úÖ Tri des chambres par num√©ro",
    "‚úÖ Format de date fran√ßais coh√©rent",
    "‚úÖ S√©lection visuelle claire avec background bleu",
    "‚úÖ D√©sactivation du bouton Valider si pas de s√©lection"
  ],
  "criticalGaps": [
    "üî¥ Table gm-recherche (cafil008_dat) non utilis√©e alors qu'elle est marqu√©e READ dans la spec",
    "üî¥ Logique de mise √† jour de la table hebergement non visible (juste appel API)",
    "üî¥ Pas de validation que le client a bien plusieurs chambres (pourrait afficher l'√©cran m√™me avec 1 seule chambre)",
    "üü° Filtrage des h√©bergements actifs fait dans mock mais pas dans le store",
    "üü° Types incomplets par rapport aux sch√©mas SQL r√©els"
  ],
  "migrationReadiness": {
    "overall": "MOYEN",
    "frontend": "PR√äT √† 85% - UI fonctionnelle mais validation business incompl√®te",
    "backend": "REQUIS - Endpoints √† cr√©er avec logique compl√®te des 4 tables",
    "testing": "NON D√âMARR√â - Aucun test g√©n√©r√©",
    "documentation": "PARTIELLE - Code bien structur√© mais manque docs API"
  }
}
